{"version":3,"sources":["../../../src/webgl-utils/create-headless-context.js"],"names":["isBrowser","ERR_HEADLESSGL_LOAD","ERR_HEADLESSGL_NOT_AVAILABLE","ERR_HEADLESSGL_FAILED","headlessGL","headlessTypes","module","require","error","console","message","warn","WebGLRenderingContext","isWebglAvailable","createHeadlessContext","width","height","opts","onError","webgl1","webgl2","gl"],"mappings":"AAAA;;AACA;AACA,OAAOA,SAAP,MAAsB,qBAAtB;AAEA,MAAMC,sBAAuB;gEAA7B;AAGA,MAAMC,+BACN,sEADA;AAGA,MAAMC,wBACN,sEADA;AAGA,OAAO,IAAIC,aAAa,IAAjB;AACP,OAAO,IAAIC,gBAAgB,IAApB;;AAEP,IAAI,CAACL,SAAL,EAAgB;AACd,MAAI;AACFI,iBAAaE,OAAOC,OAAP,CAAe,IAAf,CAAb;AACAF,oBAAgBC,OAAOC,OAAP,CAAe,SAAf,CAAhB;AACD,GAHD,CAGE,OAAOC,KAAP,EAAc;AACdC,YAAQD,KAAR;AACAC,YAAQD,KAAR,CAAe,GAAEP,mBAAoB,KAAIO,MAAME,OAAQ,EAAvD;AACD;;AACDD,UAAQE,IAAR,CAAaN,iBAAiBA,cAAcO,qBAA5C;AACD;;AAED,OAAO,MAAMC,mBAAmBb,aAAaI,UAAtC,C,CAEP;;AACA,OAAO,SAASU,qBAAT,CAA+B;AAACC,OAAD;AAAQC,QAAR;AAAgBC,MAAhB;AAAsBC;AAAtB,CAA/B,EAA+D;AAAA,QAC7DC,MAD6D,GAC3CF,IAD2C,CAC7DE,MAD6D;AAAA,QACrDC,MADqD,GAC3CH,IAD2C,CACrDG,MADqD;;AAEpE,MAAIA,UAAU,CAACD,MAAf,EAAuB;AACrB,WAAOD,QAAQ,qCAAR,CAAP;AACD;;AACD,MAAI,CAACd,UAAL,EAAiB;AACf,WAAOc,QAAQhB,4BAAR,CAAP;AACD;;AACD,QAAMmB,KAAKjB,WAAWW,KAAX,EAAkBC,MAAlB,EAA0BC,IAA1B,CAAX;;AACA,MAAI,CAACI,EAAL,EAAS;AACP,WAAOH,QAAQf,qBAAR,CAAP;AACD;;AACD,SAAOkB,EAAP;AACD","sourcesContent":["/* eslint-disable quotes, no-console */\n/* global console */\nimport isBrowser from '../utils/is-browser';\n\nconst ERR_HEADLESSGL_LOAD = `\\\nWebGL not available in Node.js, install using \"npm install gl\".`;\n\nconst ERR_HEADLESSGL_NOT_AVAILABLE =\n'Failed to create WebGL context in Node.js, headless gl not available';\n\nconst ERR_HEADLESSGL_FAILED =\n'Failed to create WebGL context in Node.js, headless gl returned null';\n\nexport let headlessGL = null;\nexport let headlessTypes = null;\n\nif (!isBrowser) {\n  try {\n    headlessGL = module.require('gl');\n    headlessTypes = module.require('gl/wrap');\n  } catch (error) {\n    console.error();\n    console.error(`${ERR_HEADLESSGL_LOAD}\\n${error.message}`);\n  }\n  console.warn(headlessTypes && headlessTypes.WebGLRenderingContext);\n}\n\nexport const isWebglAvailable = isBrowser || headlessGL;\n\n// Create headless gl context (for running under Node.js)\nexport function createHeadlessContext({width, height, opts, onError}) {\n  const {webgl1, webgl2} = opts;\n  if (webgl2 && !webgl1) {\n    return onError('headless-gl does not support WebGL2');\n  }\n  if (!headlessGL) {\n    return onError(ERR_HEADLESSGL_NOT_AVAILABLE);\n  }\n  const gl = headlessGL(width, height, opts);\n  if (!gl) {\n    return onError(ERR_HEADLESSGL_FAILED);\n  }\n  return gl;\n}\n"],"file":"create-headless-context.js"}